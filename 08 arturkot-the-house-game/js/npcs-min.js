var npc={fish:{select:function(){var e=$("#fish, #fish_click_area");return e},click_area:function(){$("<div/>",{id:"fish_click_area"}).appendTo("#floor")},swim:function(){if($.inArray("disappear",fish)===-1){$(npc.fish.select()).sprite({fps:8,no_of_frames:5});npc.fish.click_area();npc.fish.move();npc.fish.react();$("#key").hide()}else{$(npc.fish.select()).remove();npc.fish.key()}},move:function(e){var t=$("#fish");e?t.spToggle().fps(8).spState(2):t.spState(2);var e=function(t){t.animate({left:242,top:-236},5e3,"linear",function(){t.spState(3)}).animate({left:-129,top:-84},5e3,"linear",function(){if(!window.test){t.spState(2);e(t)}})};e(t);e($("#fish_click_area"))},move_to_player:function(e,t){t&&e.spToggle();e.stop(!0).animate({left:98,top:-190},200).css("background-position","0 0")},react:function(){$(npc.fish.select()).click(function(){room.the_player.go_to.start({target:"1-3",action:function(){$(room.player_body()).css("background-position","-310px 0px");npc.fish.move_to_player($("#fish"),!0);npc.fish.move_to_player($("#fish_click_area"));room.center(!0,100);dialogue_box.display({character:"Fish",picture:"aquarium_fish_big.png",text:"Hello!",options:["Hi.","I don't have time to talk with you."]});$("#options").on("click","#option_1",function(){dialogue_box.destroy();npc.fish.move(!0);$("#fish").text_cloud("Oh really? I have A LOT.",8e3)});$("#options").on("click","#option_0",function(){dialogue_box.display({character:"Fish",picture:"aquarium_fish_big.png",text:"Tell me... Did you look through the window?",options:["Yes I did.","No."]});$("#options").on("click","#option_1",function(){dialogue_box.destroy();npc.fish.move(!0);$("#fish").text_cloud("So please take a look and tell me what did you see.",1e4);$("#teleport, #exit").show("slow")});$.inArray("window",fish)===-1?$("#options").on("click","#option_0",function(){dialogue_box.display({character:"Fish",picture:"aquarium_fish_big.png",text:"So what did you see then?",options:["..."]});$("#options").on("click","#option_0",function(){dialogue_box.destroy();npc.fish.move(!0);$("#fish").text_cloud("Yeah. C'mon! Check that window.",8e3);$("#teleport, #exit").show("slow")})}):$("#options").on("click","#option_0",function(){dialogue_box.display({character:"Fish",picture:"aquarium_fish_big.png",text:"So what did you see than?",options:["Many flying... Objects?"]});$("#options").on("click","#option_0",function(){dialogue_box.destroy();$("#fish_click_area").remove();$("#fish").text_cloud("Wow. I have to check it out!",3e3);$("#fish").stop(!0,!0).delay(2e3).animate({opacity:0},3e3,function(){$(this).remove()});npc.fish.key();var e=$.jStorage.get("fish");e.push("disappear");$.jStorage.set("fish",e)})})})}})})},key:function(){$("#aquarium").find("#key").click(function(){room.the_player.go_to.start({target:"18-5",action:function(){items.take("#key");$("#teleport, #exit").show("slow")}})});$("#key").fadeIn()}},furnace:{furnace_use:function(){var e=$("#furnace_use");return e},furnace:function(){var e=$("#furnace");return e},body:function(){var e=$("#body");return e},eyes:function(){var e=$("#left_eye, #right_eye");return e},mouth:function(){var e=$("#mouth");return e},fire:function(){var e=$(".fire");return e},burn:function(){function t(){e.animate({opacity:.8},200).animate({opacity:.6},250).animate({opacity:.85},200).animate({opacity:.65},100).animate({opacity:.9},150).animate({opacity:.65},200,function(){t()})}var e=npc.furnace.fire();t()},has_food:function(){if($.inArray("twig",collected)!==-1&&$.inArray("twig",used)===-1){dialogue_box.display({character:!1,picture:!1,text:"The furnace wants to eat a twig",options:["Ok","No!"]},"big");$("#options").on("click","#option_0",function(){setTimeout(function(){items.use("#twig");$("#option_0").click(function(){dialogue_box.destroy();scene.no_click(!0);setTimeout(function(){npc.furnace.furnace().text_cloud("Nom, nom, nom.",750);npc.furnace.is_eating()},500)})},500)})}else if($.inArray("note",collected)!==-1&&$.inArray("note",used)===-1&&$.inArray("scene_keypad",played)===-1){dialogue_box.display({character:!1,picture:!1,text:"The furnace wants to eat your note. You may need it later â€“ maybe you should write it down?",options:["Give a note.","Keep a note to yourself."]},"big");$("#options").on("click","#option_0",function(){setTimeout(function(){items.use("#note");$("#option_0").click(function(){dialogue_box.destroy();scene.no_click(!0);setTimeout(function(){npc.furnace.furnace().text_cloud("Nom, nom, nom.",750);npc.furnace.is_eating()},500)})},500)})}else if($.inArray("note",collected)!==-1&&$.inArray("note",used)===-1){dialogue_box.display({character:!1,picture:!1,text:"The furnace want's to eat your note.",options:["Ok","No!"]},"big");$("#options").on("click","#option_0",function(){setTimeout(function(){items.use("#note");$("#option_0").click(function(){dialogue_box.destroy();scene.no_click(!0);setTimeout(function(){npc.furnace.furnace().text_cloud("Nom, nom, nom.",750);npc.furnace.is_eating()},500)})},500)})}else if($.inArray("coal",collected)!==-1&&$.inArray("coal",used)===-1){dialogue_box.display({character:!1,picture:!1,text:"The furnace want's to eat a coal.",options:["Ok","No!"]},"big");$("#options").on("click","#option_0",function(){setTimeout(function(){items.use("#coal");$("#option_0").click(function(){dialogue_box.destroy();scene.no_click(!0);setTimeout(function(){npc.furnace.furnace().text_cloud("Nom, nom, nom.",750);npc.furnace.is_eating()},500)})},500)})}$("#options").on("click","#option_1",function(){dialogue_box.destroy()})},is_eating:function(){var e=npc.furnace.mouth(),t=npc.furnace.eyes(),n=function(){setTimeout(function(){if($.inArray("coal",used)===-1||$.inArray("twig",used)===-1||$.inArray("note",used)===-1){Modernizr.csstransitions?e.transition({top:"-=80"},250).transition({top:"+=80"},100,function(){sound_clong.play()}):e.animate({top:"-=80"},250).animate({top:"+=80"},100,function(){sound_clong.play()});npc.furnace.furnace().text_cloud("I want more!",1e3);scene.no_click(!1)}else npc.furnace.is_strong()},500)};t.animate({opacity:.5},375).animate({opacity:0},375);Modernizr.csstransitions?e.transition({top:"-=80"},250).transition({top:"+=80"},100,function(){sound_clang.play()}).transition({top:"-=80"},100).transition({top:"+=80"},100,function(){sound_clang.play()}).transition({top:"-=80"},100).transition({top:"+=80"},100,function(){sound_clang.play();n()}):e.animate({top:"-=80"},250).animate({top:"+=80"},100,function(){sound_clang.play()}).animate({top:"-=80"},100).animate({top:"+=80"},100,function(){sound_clang.play()}).animate({top:"-=80"},100).animate({top:"+=80"},100,function(){sound_clang.play();n()})},is_strong:function(){var e=npc.furnace.furnace(),t=npc.furnace.body(),n=npc.furnace.eyes(),r=npc.furnace.mouth(),i=npc.furnace.fire();e.text_cloud("YEAH!",2e3);r.attr("style","");if(!Modernizr.csstransitions){t.css({rotate:"rotate(0deg)"});t.animate({top:15},500,function(){sound_screech.play()}).animate({top:-3},100).delay(300).animate({top:15},100).animate({top:0},500)}else t.transition({top:15,rotate:0},500,function(){sound_screech.play()}).transition({top:-3},100).transition({top:15,delay:300},100).transition({top:0},500);e.delay(600).animate({top:"-=20"},200).animate({top:"+=20"},100,function(){sound_clang.play()});r.animate({top:435},700).animate({top:515},200).animate({top:495},100).animate({top:515},100,function(){scene.no_click(!1);sound_clong.play();soundManager.resume("boiler_room");e.text_cloud("Thank you man!",2e3);setTimeout(function(){e.text_cloud("Check your room! Things have changed!",2e3)},3e3);npc.furnace.burn();npc.furnace.random_moves();var t=$.jStorage.get("played");t.push("scene_furnace");$.jStorage.set("played",t);npc.furnace.furnace_use().remove()})},is_weak:function(){var e=npc.furnace.furnace(),t=npc.furnace.body(),n=npc.furnace.eyes(),r=npc.furnace.mouth(),i=npc.furnace.fire();scene.no_click(!0);$.inArray("twig",used)===-1?e.text_cloud("I'm weak...",2e3):$.inArray("note",used)===-1?e.text_cloud("Help me please...",2e3):$.inArray("coal",used)===-1&&e.text_cloud("Still hungry...",2e3);i.animate({opacity:.5},1700).animate({opacity:0},300,function(){scene.no_click(!1);npc.furnace.has_food()});sound_screech.play();if(!Modernizr.csstransitions){t.animate({top:5,rotate:1},1700).animate({top:10,rotate:-0.5},100).animate({top:7},50).animate({top:10},50).animate({top:8},50).animate({top:10},50);r.animate({top:"-=10"},1700).animate({top:"+=10"},100,function(){sound_clong.play()}).animate({top:"-=7"},50).animate({top:"+=7"},50).animate({top:"-=5"},50).animate({top:"+=5"},50,function(){sound_clang.play()})}else{t.transition({top:5,rotate:1},1700).transition({top:10,rotate:-0.5},100).transition({top:7},50).transition({top:10},50).transition({top:8},50).transition({top:10},50);r.transition({top:"-=10"},1700).transition({top:"+=10"},100,function(){sound_clong.play()}).transition({top:"-=7"},50).transition({top:"+=7"},50).transition({top:"-=5"},50).transition({top:"+=5"},50,function(){sound_clang.play()})}},random_moves:function(){var e=npc.furnace.body();window.timer=setInterval(function(){var t=Math.random()*1;t>.5?e.transition({rotate:.5},500).transition({rotate:1},200).transition({rotate:-0.5},500).transition({rotate:-2},200).transition({rotate:.5},500).transition({rotate:1},200).transition({rotate:-0.5},500).transition({rotate:-2},200).transition({rotate:0},300):e.transition({top:"-=5",rotate:1},500).transition({top:"+=20"},200).transition({top:"-=15",rotate:-2},500).transition({top:"+=5"},500).transition({top:"-=5",rotate:0},500)},(Math.random()*8+6)*1e3)}}};